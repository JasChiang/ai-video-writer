# 頻道分析搜尋策略：技術考量與一致性

本文件旨在解釋 AI Video Writer 中，頻道分析搜尋功能為何採用與文章生成相同的影片搜尋策略。此策略確保了數據的一致性、完整性及搜尋行為的穩定性。

## 💡 核心考量

### 1. 資料來源一致性

-   **問題**：若頻道分析僅掃描播放清單 (`playlistItems.list`)，會受限於 API 的分頁上限（例如 40 頁），且影片隱私狀態或排序變更可能導致遺漏。
-   **解決方案**：採用與文章生成頁面相同的 `youtube.search.list` 搭配 `youtube.videos.list` 策略。這確保了兩者都能以「先獲取完整的 `videoId` 清單，再進行後續處理」為基礎，保證數據來源的完整與一致。

### 2. 包含所有影片類型

-   **問題**：僅依賴播放清單或公開篩選會遺漏未公開或私人影片的數據，導致分析結果與實際情況（如 YouTube Studio 或 Looker Studio）不符。
-   **解決方案**：`youtube.search.list` 搭配 `forMine: true` 參數，能夠返回使用者頻道的所有影片，無論其隱私狀態（公開、未列出、私人），確保所有影片數據都被納入分析。

### 3. 穩定的關鍵字搜尋行為

-   **問題**：如果自行遍歷播放清單並手動比對標題/描述，搜尋結果會受資料量、大小寫、語系等因素影響，難以與 YouTube 官方的搜尋邏輯保持一致。
-   **解決方案**：先透過 YouTube 官方的 `Search API` 獲取候選影片，再由 `youtube.videos.list` 取得詳細資訊，最後才進行自訂關鍵字過濾。這確保了排序和模糊比對邏輯與應用程式其他部分（如文章生成頁面）保持一致。

### 4. 精準的數據對應

-   **問題**：如果在搜尋階段就遺漏了影片，後續的分析（如 `youtubeAnalytics.reports.query`）無論多麼完整也無法彌補。
-   **解決方案**：透過一致的搜尋策略，我們能確保獲得精準的 `videoId` 集合。隨後，使用這些 `videoId` 查詢 `youtubeAnalytics.reports.query`，即可精確對應每支影片在指定日期範圍內的觀看數和互動數，確保分析的準確性。

## 結論

採用統一的影片搜尋策略，是確保 AI Video Writer 頻道分析功能數據準確、行為穩定，並與 YouTube 官方數據保持一致的關鍵。這不僅提升了開發效率，也為用戶提供了更可靠的分析結果。