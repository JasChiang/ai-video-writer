# 🧪 應用程式測試檢查清單

本檢查清單提供 AI Video Writer 應用程式在不同環境和功能模組下的測試項目，旨在協助開發者和測試人員快速驗證應用程式的正確性與穩定性。

## 📋 本地開發環境測試

### 1. OAuth 認證與 Token 管理

-   [ ] **登入流程**：
    -   [ ] 成功登入 YouTube 帳號後，瀏覽器 Console 顯示 `Access Token: ✅ 已取得`。
    -   [ ] 後端日誌顯示 `OAuth Token: ✅ 已提供`。
    -   [ ] 確認 `accessToken` 不為空。
-   [ ] **帳號切換**：
    -   [ ] 登入帳號 A，確認獲得 token A。
    -   [ ] 登出應用程式，確認 `localStorage` 中的 token 已清除。
    -   [ ] 登入帳號 B，確認獲得 token B (不同於 A)。
    -   [ ] 確認兩個帳號各自擁有獨立的 API 額度管理。

### 2. 影片下載與處理

-   [ ] **未公開影片下載**：
    -   [ ] 上傳一個未公開影片到 YouTube。
    -   [ ] 在應用程式中選擇該影片，嘗試生成中繼資料或文章。
    -   [ ] 確認後端使用 OAuth 認證成功下載影片。
    -   [ ] 確認沒有出現 "bot" 相關錯誤。
    -   [ ] 確認影片成功下載到 `temp_videos/` 目錄。
-   [ ] **公開影片處理**：
    -   [ ] 選擇一個公開影片。
    -   [ ] 嘗試生成中繼資料或文章。
    -   [ ] 確認應用程式使用 Gemini 的 YouTube URL 功能（不進行本地下載）。
    -   [ ] 確認成功生成內容，且不消耗本地下載額度。

### 3. 速率限制處理

-   [ ] **帳號層級速率限制**：
    -   [ ] 執行 1-10 次 API 請求（例如生成中繼資料）。
    -   [ ] 第 11 次請求應返回 HTTP 429 錯誤。
    -   [ ] 錯誤訊息應包含 `limitType: 'account'`。
    -   [ ] 應用程式應顯示正確的等待時間提示。
-   [ ] **IP 層級速率限制**：
    -   [ ] 使用多個帳號（或同一帳號）總共發出 20 次請求。
    -   [ ] 第 21 次請求應返回 HTTP 429 錯誤。
    -   [ ] 錯誤訊息應包含 `limitType: 'ip'`。
    -   [ ] 應用程式應顯示正確的等待時間提示。

### 4. 檔案快取與重用

-   [ ] **首次下載與上傳**：
    -   [ ] 第一次處理某影片時，確認影片被下載並上傳到 Gemini Files API。
-   [ ] **檔案重用**：
    -   [ ] 第二次處理同一影片時，確認後端日誌顯示 "Reused existing file" 或類似訊息。
    -   [ ] 確認沒有重複下載或上傳。

## ☁️ Render 部署環境測試

### 1. 環境變數設定

-   [ ] 確認 Render 環境中已設定所有必要的環境變數：
    -   `GEMINI_API_KEY`
    -   `YOUTUBE_CLIENT_ID`
    -   `YOUTUBE_CLIENT_SECRET`
    -   `YOUTUBE_REFRESH_TOKEN`
    -   `YOUTUBE_CHANNEL_ID`
    -   `FRONTEND_URL`, `VITE_SERVER_BASE_URL`, `VITE_API_URL` (與 Render 服務 URL 一致)

### 2. 基本功能驗證

-   [ ] 應用程式在 Render 上可以正常開啟。
-   [ ] 可以成功登入 YouTube。
-   [ ] 可以看到影片列表。
-   [ ] 可以成功生成中繼資料和文章。

### 3. OAuth Token 處理 (Render)

-   [ ] 登入後，檢查 Render 服務日誌，確認顯示 `OAuth Token: ✅ 已提供`。
-   [ ] 選擇未公開影片，嘗試生成中繼資料，確認成功。

### 4. 速率限制 (Render)

-   [ ] 使用測試工具或手動測試，驗證 Render 部署的應用程式速率限制是否正常觸發。
-   [ ] 檢查 Render 日誌，確認顯示正確的速率限制相關訊息。

### 5. 性能與穩定性

-   [ ] 影片下載速度正常，沒有明顯延遲。
-   [ ] 沒有出現超時錯誤。
-   [ ] 應用程式記憶體使用量在可接受範圍內。

## ⚠️ 邊界與異常情況測試

-   [ ] **未登入狀態**：嘗試處理未公開影片，應提示登入或失敗。
-   [ ] **無效的 `videoId`**：輸入無效的 YouTube 影片 ID，應返回 HTTP 400 錯誤。
-   [ ] **網路中斷**：模擬網路中斷，確認應用程式能正確處理錯誤並給予提示。
-   [ ] **Token 過期**：模擬 YouTube Access Token 過期，確認應用程式能提示重新登入或自動刷新。

## 📝 測試結果記錄

**測試日期**：___________________
**測試人員**：___________________

**通過項目**：____ / ____
**失敗項目**：____ / ____

### 問題記錄：
1.  ...
2.  ...
3.  ...

### 備註：
____________________________________________________________________________________________________

---

## 📚 相關文件

-   [影片表現分析功能：測試指南](./VIDEO_ANALYTICS_TESTING_GUIDE.md)
-   [問題排除指南](./TROUBLESHOOTING.md)
-   [安全性測試指南](./SECURITY_TESTING.md)
```